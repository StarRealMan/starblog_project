title: 技术传承——永磁同步电机驱动2
date: 2020-02-24 05:25:00
categories: control
tags: []
---
万众期待的P2来啦，这次为大家更新电流环与无感部分
正好和要申的一个专利相关，就白嫖了一点过来
自己白嫖自己应该不算什么侵权吧/笑哭

----------
## 电流环控制——复矢量解耦 ##
首先，电流采样得到电机三相线上的交变电流，依次经过Clark变换、Park’变换，得到相对转子静止的旋转坐标系下电流，即Iq（q轴电流）与Id（d轴电流），通过复矢量解耦与PI控制器的方法计算出当前应加载在q、d轴上的电压Uq与Ud，进一步，再使用反Park变换计算出静止坐标系下交变电压Uα、Uβ，即可通过SVPWM调制得到三相方波占空比，控制永磁同步电机的电流，进而控制电机力矩。
**复矢量控制器的构造方法如下:**
![ses1.PNG][1]
对于隐极电机，有Ld=Lq=L
可以看到q、d轴电压方程之间互相包含对方的电流，明显是一个耦合的系统。传统控制方法通过前馈的方法进行解耦，即在最终输入电机系统之前在输出电压值上补偿数学模型中![ses17.PNG][2]这一项，系统就可以得到解耦。然而，前馈解耦的方法过渡依赖于电机参数，即我们必须得到准确的Ld、Lq以及![ses18.PNG][3]才能够较好地消除耦合影响。由此导致采用前馈解耦控制方法的电机存在电流波动，相应慢的缺陷。
本专利采用一种新型的复矢量解耦的方法进行电流环控制：
首先构造控制量，构造电流复矢量i_S，其实部由id构成，虚部由iq构成，则有:
![ses2.PNG][4]
同理，我们可以构造电压复矢量U_S，其实部u_d由构成，虚部由u_q构成，则有:
![ses3.PNG][5]
将上述方程与电机数学模型联立，可得到由电流、电压复矢量构成的新的电压方程如下：
![ses4.PNG][6]
由此可见，我们已经将两个互相耦合的系统变为一个整体，此时我们只需输出电压Us，即可控制电流is，在控制is的同时，id与iq也就得到了控制。

**采取PI控制器控制:**
![ses5.PNG][7]
其中PI参数可选取![ses19.PNG][8]控制系统带宽，有alpha越大，带宽越大，电流响应速度越快。但alpha不可无限制地增加，应考虑控制器输出电压的范围合理设计alpha的值。
最后在最终输出的uq部分可以前馈补偿上![ses20.PNG][9]![ses18.PNG][10]，使模型更加拟合真实模型。

## 角度观测——扩张+龙伯格（Extended Luenberger Observer） ##
电流环控制器设计完成后，我们考虑无传感器设计方案。传统无传感器算法通常采用六步换向法，即通过检测三相线上的反电动势来估计转子位置，通过控制逆变器的六种状态来实现电机的无传感器运行。但这种方法无法精确控制电流，且最终电流波形为方波而非正弦波，就可能导致电机运行不平稳，调速不灵活等问题。本专利采取无传感器FOC控制算法，可以精确控制电流，实现电机平稳运行。使用龙伯格观测器观测电机的位置与速度，为FOC算法提供位置参考。
无传感器算法运行原理如下：
启动前首先通过控制恒定的A相电流，电流产生的磁场使得电机转子转动到固定的启动位置，随后开启开环启动流程。
开环启动时通过控制电流矢量的转动带动转子进行旋转，其中电流矢量旋转的速度与我们想要控制电机的速度相同
当电机达到一定速度时，停止增大电流适量转速，此时电机会保持恒定的转速，此时产生的转矩与阻力相等，电流矢量一部分是q轴电流，一部分是d轴电流。适当降低电流大小使得转子角度更接近设定的电流矢量的角度。
最后开启观测器，待观测器收敛，FOC算法使用观测到的角度，再由速度开环切换到速度闭环即可完成一次无传感器启动。
**龙伯格观测器算法原理：**
首先建立静止坐标系下电机模型:
![ses6.PNG][11]
其中:
![ses7.PNG][12]
把扰动E当作一个状态变量，则得到状态向量为:
![ses8.PNG][13]
扩张后的状态方程为:
![ses9.PNG][14]
其中：
![ses10.PNG][15]
此处假设了![ses21.PNG][16]的倒数均为0，即![ses21.PNG][16]变化率为零。
构建龙伯格观测器:
![ses11.PNG][17]
其中K为观测器增益，是一个四行一列的矩阵，且应该有![ses12.PNG][18]的形式。
在满足能观性的前提下，通过调节K的值，可以设定观测器的带宽。
最终即可得到![ses21.PNG][16]的观测值。
根据电机数学模型，有:![ses13.PNG][19]，可由反三角函数计算出电角度的值:
![ses14.PNG][20]
微分可计算出电角速度:
![ses15.PNG][21]
观测器模型的改进:
此前我们假设了![ses21.PNG][16]变化率为零，但由上式我们得知，![ses21.PNG][16]存在明显的微积分关系，可进一步改进观测器模型为
![ses16.PNG][22]
可以进一步提升观测器跟随效果。

## 框图 ##
具体的系统框图如下：
![elob.jpg][23]
![complexV.jpg][24]


**下期应该会出SVPWM和逆变器部分！**
计网也在好好看啦（才怪）

  [1]: /old_images/2020/02/701335943.png
  [2]: /old_images/2020/02/2322548764.png
  [3]: /old_images/2020/02/17198532.png
  [4]: /old_images/2020/02/3215796440.png
  [5]: /old_images/2020/02/3576370167.png
  [6]: /old_images/2020/02/1328380167.png
  [7]: /old_images/2020/02/1502540671.png
  [8]: /old_images/2020/02/1919880935.png
  [9]: /old_images/2020/02/3577136343.png
  [10]: /old_images/2020/02/17198532.png
  [11]: /old_images/2020/02/462653967.png
  [12]: /old_images/2020/02/3108166881.png
  [13]: /old_images/2020/02/1004013066.png
  [14]: /old_images/2020/02/2865477902.png
  [15]: /old_images/2020/02/1782312365.png
  [16]: /old_images/2020/02/3694597941.png
  [17]: /old_images/2020/02/3056175988.png
  [18]: /old_images/2020/02/1298152153.png
  [19]: /old_images/2020/02/2677382250.png
  [20]: /old_images/2020/02/1013716568.png
  [21]: /old_images/2020/02/2670368623.png
  [22]: /old_images/2020/02/698813314.png
  [23]: /old_images/2020/02/2260242333.jpg
  [24]: /old_images/2020/02/915343109.jpg
